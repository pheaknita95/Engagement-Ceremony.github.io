<!doctype html>
<html lang="km">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>áŸá·ášá¸á˜á„áŸ’á‚á›á¢á¶á–á¶á áŸá–á·á–á¶á áŸ - áŸá™ áœáŸ‰á¶á“áŸ‹áŒá¸ ğŸ’ á¡áŸá„ áŸáŸŠá¶á„á›á¸áŸ</title>
    <meta property="twitter:image" content="https://i.postimg.cc/NjXxFbDQ/bg-frame.jpg"/>
    <meta property="twitter:card" content="summary_large_image"/>

  <!-- NOTE: For Facebook/Messenger preview, update og:title / og:description / og:image in <head> too. -->
  <!-- Open Graph Preview (for Messenger / Facebook) -->
  <meta property="og:title" content="áŸá·ášá¸á˜á„áŸ’á‚á›á¢á¶á–á¶á áŸá–á·á–á¶á áŸ - áŸá™ áœáŸ‰á¶á“áŸ‹áŒá¸ ğŸ’ á¡áŸá„ áŸáŸŠá¶á„á›á¸áŸ"/>
  <meta property="og:description" content="áŸá¼á˜á‚áŸ„ášá–á¢á‰áŸ’á‡á¾á‰á…á¼á›ášá½á˜á–á·á’á¸á¢á¶á–á¶á áŸá–á·á–á¶á áŸ ášá”áŸáŸ‹á‚á¼áŸáŸ’áœá¶á˜á¸á—ášá·á™á¶ááŸ’á˜á¸ (áŸ¡áŸ§ á˜á€ášá¶ áŸ¢áŸ áŸ¢áŸ¦)"/>
  <meta property="og:image" content="https://i.postimg.cc/NjXxFbDQ/bg-frame.jpg"/>
  <meta property="og:type" content="website" />

  <style>
    :root{
      --gold:#f5d78e;
      --gold2:#caa14a;
      --card: rgba(0,0,0,.55);
      --border: rgba(245,215,142,.25);
      --text:#f8fafc;
      --muted: rgba(248,250,252,.78);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:'Kantumruy Pro', sans-serif;
      color:var(--text);
      min-height:100vh;
      overflow:hidden;
      background: radial-gradient(circle at 20% 20%, #ffffff 0%, #eaf2ff 35%, #dbeafe 70%, #ffffff 100%);
    }
    .wrap{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      min-height:100vh;
    }
    /* LEFT */
    .left{
      position:relative;
      overflow:hidden;
      background: radial-gradient(circle at 20% 20%, #ffffff 0%, #eaf2ff 35%, #dbeafe 70%, #ffffff 100%);
    }
    .slideshow{
      position:absolute; inset:0;
    }
    .slide{
      position:absolute; inset:0;
      background-size:cover;
      background-position:center;
      opacity:0;
      transition:opacity 1.2s ease;
      transform:scale(1.02);
      will-change:opacity, transform;
      animation:kenburn 14s ease-in-out infinite;
    }
    .slide.show{opacity:1;}
    @keyframes kenburn{
      0%{transform:scale(1.02) translateX(0)}
      50%{transform:scale(1.08) translateX(-1.5%)}
      100%{transform:scale(1.02) translateX(0)}
    }

    /* RIGHT */
    .right{
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:22px;
      background:linear-gradient(90deg, rgba(0,0,0,.25), rgba(0,0,0,.55));
    }
    .glass{
      width:min(520px, 94vw);
      background:rgba(0,0,0,.55);
      border:1px solid var(--border);
      border-radius:22px;
      padding:26px 22px 20px;
      backdrop-filter: blur(10px);
      box-shadow:0 30px 70px rgba(0,0,0,.5);
      position:relative;
      overflow:hidden;
    }
    .title{
      text-align:center;
      font-size:34px;
      font-weight:900;
      color:var(--gold);
      text-shadow:0 0 18px rgba(245,215,142,.38), 0 2px 0 rgba(0,0,0,.55);
      letter-spacing:.3px;
      position:relative;
      padding-bottom:10px;
      font-family:'Noto Serif Khmer', serif;
}
    /* sparkle */
    .spark{
      position:absolute;
      inset:0;
      pointer-events:none;
    }
    .spark i{
      position:absolute;
      width:6px;height:6px;border-radius:50%;
      background:rgba(245,215,142,.95);
      box-shadow:0 0 12px rgba(245,215,142,.95);
      opacity:.0;
      animation:twinkle 3.6s linear infinite;
    }
    @keyframes twinkle{
      0%{transform:scale(.4); opacity:0}
      10%{opacity:1}
      30%{opacity:.2}
      50%{transform:scale(1.2); opacity:1}
      70%{opacity:.2}
      100%{transform:scale(.4); opacity:0}
    }
    .names{
      text-align:center;
      font-weight:900;
      color:var(--gold);
      font-size:22px;
      margin-top:6px;
    }
    .date{
      text-align:center;
      margin-top:6px;
      font-weight:900;
      font-size:18px;
      color:#fff;
    }
    .box{
      margin-top:16px;
      border:1px solid rgba(245,215,142,.2);
      border-radius:16px;
      padding:14px 14px;
      background:rgba(0,0,0,.35);
    }
    .guest-label{
      color:var(--gold);
      font-weight:900;
      margin-bottom:8px;
      font-size:18px;
    }
    .guest-name{
      font-size:22px;
      font-weight:900;
      color:#fff;
      letter-spacing:.2px;
    }
    .big{
      margin-top:14px;
      background:rgba(245,215,142,.95);
      color:#3a2a08;
      text-align:center;
      border-radius:999px;
      padding:14px 16px;
      font-weight:900;
      font-size:18px;
    }
    .info{
      margin-top:14px;
      border-radius:16px;
      border:1px solid rgba(245,215,142,.18);
      background:rgba(0,0,0,.35);
      padding:14px 14px;
    }
    .info div{display:flex; gap:10px; margin:8px 0; align-items:flex-start}
    .info b{min-width:22px; text-align:center}
    .desc{
      margin-top:14px;
      border-radius:16px;
      border:1px solid rgba(245,215,142,.18);
      background:rgba(0,0,0,.25);
      padding:14px 14px;
      color:var(--muted);
      line-height:1.65;
      font-size:14px;
    }
    .contact{
      margin-top:14px;
      border-radius:16px;
      border:1px solid rgba(245,215,142,.18);
      background:rgba(0,0,0,.25);
      padding:12px 14px;
      display:flex;
      justify-content:center;
      gap:12px;
      align-items:center;
      font-weight:900;
    }
    .contact span{color:var(--gold)}
    .btns{
      margin-top:14px;
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
    }
    .btn{
      border:1px solid rgba(245,215,142,.25);
      background:rgba(0,0,0,.35);
      color:#fff;
      padding:12px 16px;
      border-radius:999px;
      font-weight:900;
      cursor:pointer;
      text-decoration:none;
      display:flex;
      align-items:center;
      gap:10px;
      transition:.12s;
    }
    .btn:hover{transform:translateY(-1px); background:rgba(0,0,0,.45)}
    @media (max-width: 960px){
      body{overflow:auto}
      .wrap{grid-template-columns:1fr}
      .left{min-height:52vh}
      .right{background:linear-gradient(180deg, rgba(0,0,0,.15), rgba(0,0,0,.65))}
    }
  
.bg-slideshow .slide.active{opacity:1;transform:scale(1.0);} 
</style>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Kantumruy+Pro:wght@300;400;500;600;700&family=Noto+Serif+Khmer:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>

  <!-- ===========================
       ğŸ” Admin Panel UI (Ctrl+Alt+A to toggle)
       =========================== -->
  <button id="adminToggleBtn" aria-label="Open admin panel"
    style="position:fixed;bottom:18px;right:18px;z-index:9999;border:none;border-radius:999px;padding:12px 14px;box-shadow:0 10px 25px rgba(0,0,0,.18);background:#111;color:#fff;font-weight:700;cursor:pointer;">
    âš™ï¸ Admin
  </button>

  <div id="adminPanel" style="position:fixed;inset:0;z-index:9998;display:none;">
    <div id="adminBackdrop" style="position:absolute;inset:0;background:rgba(0,0,0,.55);"></div>
    <div style="position:absolute;right:0;top:0;height:100%;width:min(520px,92vw);background:#fff;box-shadow:-10px 0 30px rgba(0,0,0,.25);padding:18px 18px 90px;overflow:auto;">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
        <div>
          <div style="font-size:18px;font-weight:800;">Admin Panel</div>
          <div style="font-size:12px;opacity:.7;">á€áŸ‚á–áŸááŸŒá˜á¶á“á‘á¶áŸ†á„á¢áŸáŸ‹ â†’ á…á»á… Apply/Save</div>
        </div>
        <div style="display:flex;gap:8px;align-items:center;"><button id="adminLogoutBtn" style="border:none;background:#fff;border:1px solid #ddd;border-radius:12px;padding:10px 12px;cursor:pointer;font-weight:800;">ğŸšª Logout</button><button id="adminCloseBtn" style="border:none;background:#f2f2f2;border-radius:12px;padding:10px 12px;cursor:pointer;font-weight:700;">âœ• Close</button></div>
      </div>

      <hr style="margin:14px 0;border:none;border-top:1px solid #eee;"/>

      <div style="display:grid;gap:12px;">
        <label style="display:grid;gap:6px;font-weight:700;">Title
          <input id="f_title" type="text" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
        </label>

        <label style="display:grid;gap:6px;font-weight:700;">Couple
          <input id="f_couple" type="text" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
        </label>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
          <label style="display:grid;gap:6px;font-weight:700;">Date (Short)
            <input id="f_dateShort" type="text" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
          </label>
          <label style="display:grid;gap:6px;font-weight:700;">Time
            <input id="f_time" type="text" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
          </label>
        </div>

        <label style="display:grid;gap:6px;font-weight:700;">Date (Full)
          <input id="f_dateFull" type="text" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
        </label>

        <label style="display:grid;gap:6px;font-weight:700;">Guest Label
          <input id="f_guestLabel" type="text" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
        </label>

        <label style="display:grid;gap:6px;font-weight:700;">Big Text
          <input id="f_bigText" type="text" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
        </label>

        <label style="display:grid;gap:6px;font-weight:700;">Location
          <input id="f_location" type="text" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
        </label>

        <label style="display:grid;gap:6px;font-weight:700;">Description (Long)
          <textarea id="f_desc" rows="4" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;resize:vertical;"></textarea>
        </label>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
          <label style="display:grid;gap:6px;font-weight:700;">Phone (Display)
            <input id="f_phoneDisplay" type="text" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
          </label>
          <label style="display:grid;gap:6px;font-weight:700;">Phone (tel:)
            <input id="f_phoneTel" type="text" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
          </label>
        </div>

        <label style="display:grid;gap:6px;font-weight:700;">Map Link
          <input id="f_mapLink" type="text" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
        </label>

        <div style="display:grid;gap:8px;">
          <div style="font-weight:800;">Slides (4 links)</div>
          <input id="f_slide1" type="text" placeholder="Slide 1 link" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
          <input id="f_slide2" type="text" placeholder="Slide 2 link" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
          <input id="f_slide3" type="text" placeholder="Slide 3 link" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
          <input id="f_slide4" type="text" placeholder="Slide 4 link" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
        </div>

        <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px;">
          <button id="adminApplyBtn" style="border:none;border-radius:14px;padding:12px 14px;background:#111;color:#fff;font-weight:800;cursor:pointer;">âœ… Apply</button>
          <button id="adminSaveBtn" style="border:none;border-radius:14px;padding:12px 14px;background:#2563eb;color:#fff;font-weight:800;cursor:pointer;">ğŸ’¾ Save</button>
          <button id="adminResetBtn" style="border:1px solid #ddd;border-radius:14px;padding:12px 14px;background:#fff;color:#111;font-weight:800;cursor:pointer;">â†© Reset Saved</button>
          <button id="adminChangePassBtn" style="border:1px solid #ddd;border-radius:14px;padding:12px 14px;background:#fff;color:#111;font-weight:800;cursor:pointer;">ğŸ”‘ Change Password</button>
          <div style="flex-basis:100%;height:0;"></div>
          <label style="display:grid;gap:6px;font-weight:800;flex:1;min-width:220px;">Guest Name (áŸá˜áŸ’ášá¶á”áŸ‹ Copy Link)
            <input id="f_guestCopy" type="text" placeholder="á§: á›áŸ„á€ áŸá»áá¶" style="padding:10px 12px;border:1px solid #ddd;border-radius:12px;width:100%;"/>
          </label>
          <button id="adminCopyLinkBtn" style="border:1px solid #ddd;border-radius:14px;padding:12px 14px;background:#fff;color:#111;font-weight:800;cursor:pointer;">ğŸ”— Copy Link</button>
          <button id="adminDownloadBtn" style="border:1px solid #ddd;border-radius:14px;padding:12px 14px;background:#fff;color:#111;font-weight:800;cursor:pointer;">â¬‡ï¸ Download</button>
          <button id="adminDownloadImagesBtn" style="border:1px solid #ddd;border-radius:14px;padding:12px 14px;background:#fff;color:#111;font-weight:800;cursor:pointer;">ğŸ–¼ï¸ Download Images</button>
        </div>

        <div style="font-size:12px;opacity:.75;line-height:1.45;margin-top:6px;">
          Tip: á…á»á… <b>Ctrl + Alt + A</b> áŠá¾á˜áŸ’á”á¸á”á¾á€/á”á·á‘ panel á”á¶á“á›á¿á“áŸ”<br/>
          Note: Facebook preview (og:image) á“áŸ…á€áŸ’á“á»á„ &lt;head&gt; ááŸ’ášá¼áœá€áŸ‚áŠáŸ„á™áŠáŸƒáŸ”
        </div>
      </div>
    </div>
  </div>


  <script>
    /* ===========================
       âœ… EDITABLE SETTINGS (á€áŸ‚ááŸ’ášá„áŸ‹á“áŸáŸ‡ááŸ‚á˜á½á™á€á“áŸ’á›áŸ‚á„)
       =========================== */
    const ADMIN_PASSWORD = "Reaksaads050796";
    const ADMIN_SETTINGS = {
      hideAdminButton: true, // true = hide âš™ï¸ Admin button (use Ctrl+Alt+A)
      autoLockMinutes: 15     // auto-lock after X minutes of inactivity
    };
    const WEDDING = {
      title: "áŸá·ášá¸á˜á„áŸ’á‚á›á¢á¶á–á¶á áŸá–á·á–á¶á áŸ",
      couple: "áŸá™ áœáŸ‰á¶á“áŸ‹áŒá¸ ğŸ’ á¡áŸá„ áŸáŸŠá¶á„á›á¸áŸ",
      dateShort: "áŸ¡áŸ§ á˜á€ášá¶ áŸ¢áŸ áŸ¢áŸ¦",
      guestLabel: "áŸá¼á˜á‚áŸ„ášá–á¢á‰áŸ’á‡á¾á‰á—áŸ’á‰áŸ€áœá€á·ááŸ’áá·á™áŸ",
      bigText: "áŸá¼á˜á¢á‰áŸ’á‡á¾á‰á…á¼á›ášá½á˜á–á·á’á¸á¢á¶á–á¶á áŸá–á·á–á¶á áŸ",
      dateFull: "ááŸ’á„áŸƒáŸáŸ…ášáŸ á‘á¸áŸ¡áŸ§ ááŸ‚á˜á€ášá¶ á†áŸ’á“á¶áŸ†áŸ¢áŸ áŸ¢áŸ¦",
      time: "áœáŸá›á¶á˜áŸ‰áŸ„á„ áŸ¥áŸ–áŸ áŸ  á›áŸ’á„á¶á…",
      location: "á—á¼á˜á·á…á“áŸ’á›áŸ„á„ áƒá»áŸ†áŠáŸ†ášá·á› áŸáŸ’ášá»á€á¢á¼ášášá¶áŸ†á„áª ááŸááŸ’áááŸ’á”á¼á„áƒáŸ’á˜á»áŸ†",
      desc: "á™á¾á„ááŸ’á‰á»áŸ†á˜á¶á“á€á·ááŸ’áá·á™áŸáŸá¼á˜á‚áŸ„ášá–á¢á‰áŸ’á‡á¾á‰ á¯á€á§ááŸ’áá˜ á›áŸ„á€á§á€á‰áŸ‰á¶ á¢áŸ’á“á€á§á€á‰áŸ‰á¶ á§á€á‰áŸ‰á¶ á›áŸ„á€á‡áŸ†á‘á¶áœ á›áŸ„á€ á›áŸ„á€áŸáŸ’ášá¸ á¢áŸ’á“á€á“á¶á„ á€á‰áŸ’á‰á¶ á¢á‰áŸ’á‡á¾á‰á…á¼á›ášá½á˜ áŠá¾á˜áŸ’á”á¸á”áŸ’ášáŸá·á‘áŸ’á’á·á–ášá‡áŸá™áŸá·ášá¸áŸá½áŸáŸ’áá¸ á‡áŸá™á˜á„áŸ’á‚á› á€áŸ’á“á»á„á–á·á’á¸á¢á¶á–á¶á áŸá–á·á–á¶á áŸ ášá”áŸáŸ‹á‚á¼áŸáŸ’áœá¶á˜á¸á—ášá·á™á¶ááŸ’á˜á¸áŸ”",
      callLabel: "ğŸ“ á áŸ…á¥á¡á¼áœ",
      phoneDisplay: "+855 90 598 510",
      phoneTel: "+85590598510",
      mapLabel: "ğŸ“ á‘á¸áá¶áŸ†á„ (Map)",
      mapLink: "https://goo.gl/maps/KcnLyL4jv2HMGDss9",
      // Preview image used in body (Facebook preview is in <head>, please update there too)
      slides: [
        "https://i.postimg.cc/NjXxFbDQ/bg-frame.jpg",
        "https://i.postimg.cc/NjXxFbDQ/bg-frame.jpg",
        "https://i.postimg.cc/NjXxFbDQ/bg-frame.jpg",
        "https://i.postimg.cc/NjXxFbDQ/bg-frame.jpg"
      ]
    };
    // Load saved values from localStorage (if any)
    function loadWeddingFromStorage(){
      try{
        const raw = localStorage.getItem("WEDDING_SETTINGS_V1");
        if(!raw) return;
        const saved = JSON.parse(raw);
        if(saved && typeof saved === "object"){
          Object.assign(WEDDING, saved);
        }
      }catch(e){}
    }

    function saveWeddingToStorage(){
      try{
        localStorage.setItem("WEDDING_SETTINGS_V1", JSON.stringify(WEDDING));
      }catch(e){}
    }


    // Apply settings to page
    
        
    function getAdminPassword(){
      return localStorage.getItem("ADMIN_PASSWORD_OVERRIDE") || ADMIN_PASSWORD;
    }
    function setAdminPassword(newPass){
      localStorage.setItem("ADMIN_PASSWORD_OVERRIDE", newPass);
    }
    function touchAdminActivity(){
      localStorage.setItem("ADMIN_LAST_ACTIVE", String(Date.now()));
    }
    function isAutoLocked(){
      const mins = Number(ADMIN_SETTINGS.autoLockMinutes || 0);
      if(!mins) return false;
      const last = Number(localStorage.getItem("ADMIN_LAST_ACTIVE") || "0");
      if(!last) return false;
      return (Date.now() - last) > mins * 60 * 1000;
    }

function isAdminAuthed(){ return localStorage.getItem("ADMIN_AUTH")==="1" && !isAutoLocked(); }


    function applyAdminUiSettings(){
      const btn = document.getElementById("adminToggleBtn");
      if(btn && ADMIN_SETTINGS.hideAdminButton){
        btn.style.display = "none";
      }
    }

function initAdminPanel(){
      const panel = document.getElementById("adminPanel");
      const openBtn = document.getElementById("adminToggleBtn");
      const closeBtn = document.getElementById("adminCloseBtn");
      const backdrop = document.getElementById("adminBackdrop");
      const logoutBtn = document.getElementById("adminLogoutBtn");

      const open = () => {
        if(!isAdminAuthed()){
          const p = prompt("Enter admin password:");
          if(p !== getAdminPassword()){ alert("Wrong password âŒ"); return; }
          localStorage.setItem("ADMIN_AUTH", "1");
          touchAdminActivity();
        }
        panel.style.display = "block"; fillFormFromWedding(); touchAdminActivity();
      };
      const close = () => { panel.style.display = "none"; };

      // expose helpers for mobile / long-press
      window.openAdminPanel = open;
      window.closeAdminPanel = close;

      openBtn && openBtn.addEventListener("click", open);
      closeBtn && closeBtn.addEventListener("click", close);
      backdrop && backdrop.addEventListener("click", close);
      panel.addEventListener("input", touchAdminActivity);
      panel.addEventListener("click", touchAdminActivity);

      logoutBtn && logoutBtn.addEventListener("click", () => {
        localStorage.removeItem("ADMIN_AUTH");
        alert("Logged out âœ…");
        close();
      });

      
      setupLongPressAdmin(open);
      setupTap5Admin(open);

      
      function setupTap5Admin(openFn){
        const el = document.querySelector(".left") || document.querySelector(".ring");
        if(!el) return;
        let count = 0;
        let last = 0;
        const WINDOW_MS = 1500; // 5 taps within 1.5s
        el.addEventListener("click", (e) => {
          const t = e.target;
          if(t && (t.closest("a") || t.closest("button") || t.closest("input") || t.closest("textarea"))) return;
          const now = Date.now();
          if(now - last > WINDOW_MS) count = 0;
          last = now;
          count += 1;
          if(count >= 5){
            count = 0;
            openFn();
          }
        });
        el.addEventListener("touchend", (e) => {
          // touchend will also fire click sometimes; allow click handler to manage
        }, {passive:true});
      }

function setupLongPressAdmin(openFn){
        const targets = [
          document.querySelector(".ring"),
          document.querySelector(".left")
        ].filter(Boolean);
        if(!targets.length) return;

        const HOLD_MS = 700; // hold 0.7s
        targets.forEach(el => {
          let timer = null;
          const start = (e) => {
            const t = e.target;
            // avoid triggering on links/buttons/inputs/text selection
            if(t && (t.closest("a") || t.closest("button") || t.closest("input") || t.closest("textarea"))) return;
            timer = setTimeout(() => { openFn(); }, HOLD_MS);
          };
          const cancel = () => { if(timer){ clearTimeout(timer); timer=null; } };
          el.addEventListener("touchstart", start, {passive:true});
          el.addEventListener("touchend", cancel);
          el.addEventListener("touchcancel", cancel);

          // optional desktop mouse hold
          el.addEventListener("mousedown", start);
          el.addEventListener("mouseup", cancel);
          el.addEventListener("mouseleave", cancel);
        });
      }

document.addEventListener("keydown", (e) => {
        if(e.ctrlKey && e.altKey && (e.key === "a" || e.key === "A")){
          e.preventDefault();
          panel.style.display = (panel.style.display === "block") ? "none" : "block";
          if(panel.style.display === "block") fillFormFromWedding();
        }
      });

      document.getElementById("adminApplyBtn")?.addEventListener("click", () => {
        readFormToWedding();
        applyWeddingSettings();
        touchAdminActivity();
      });

      document.getElementById("adminSaveBtn")?.addEventListener("click", () => {
        readFormToWedding();
        saveWeddingToStorage();
        applyWeddingSettings();
        touchAdminActivity();
        alert("Saved âœ…");
      });

      document.getElementById("adminChangePassBtn")?.addEventListener("click", () => {
        const oldP = prompt("Old password:");
        if(oldP !== getAdminPassword()){ alert("Old password incorrect âŒ"); return; }
        const newP = prompt("New password (min 6 chars):");
        if(!newP || newP.length < 6){ alert("Password too short âŒ"); return; }
        const confirmP = prompt("Confirm new password:");
        if(confirmP !== newP){ alert("Password not match âŒ"); return; }
        setAdminPassword(newP);
        touchAdminActivity();
        alert("Change Password âœ…");
      });

      
      
      document.getElementById("adminCopyLinkBtn")?.addEventListener("click", async () => {
        const base = window.location.origin + window.location.pathname;
        const guest = (document.getElementById("f_guestCopy")?.value || "").trim();
        const url = guest ? `${base}?guest=${encodeURIComponent(guest)}` : base;
        try{
          await navigator.clipboard.writeText(url);
          alert("Copied âœ…\n" + url);
        }catch(e){
          prompt("Copy this link:", url);
        }
        touchAdminActivity();
      });

      document.getElementById("adminDownloadBtn")?.addEventListener("click", () => {
        readFormToWedding();
        saveWeddingToStorage();
        applyWeddingSettings();
        downloadSettingsFile();
        touchAdminActivity();
      });

      function downloadSettingsFile(){
        const data = {
          WEDDING,
          exportedAt: new Date().toISOString()
        };
        const blob = new Blob([JSON.stringify(data, null, 2)], {type:"application/json"});
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "wedding-settings.json";
        document.body.appendChild(a);
        a.click();
        a.remove();
        setTimeout(() => URL.revokeObjectURL(a.href), 1000);
      }

      
      document.getElementById("adminDownloadImagesBtn")?.addEventListener("click", async () => {
        readFormToWedding();
        saveWeddingToStorage();
        applyWeddingSettings();
        await downloadAllImages();
        touchAdminActivity();
      });

      async function downloadAllImages(){
        // 1) Preview image from <meta property="og:image">
        const og = document.querySelector('meta[property="og:image"]')?.getAttribute("content");
        // 2) Slides from settings
        const urls = [];
        if(og) urls.push({url: og, name: "preview.jpg"});
        (WEDDING.slides || []).forEach((u, i) => { if(u) urls.push({url: u, name: `slide-${i+1}.jpg`}); });

        if(!urls.length){
          alert("No image links found âŒ");
          return;
        }

        // Try to download sequentially; if blocked, open in new tab as fallback.
        for(const item of urls){
          await downloadImageWithFallback(item.url, item.name);
          await new Promise(r => setTimeout(r, 350));
        }
        alert("Done âœ…\nIf some files didn't download, they were opened in a new tab (browser security).");
      }

      function downloadImageWithFallback(url, filename){
        return new Promise((resolve) => {
          try{
            const a = document.createElement("a");
            a.href = url;
            a.download = filename;
            a.target = "_blank";
            document.body.appendChild(a);
            a.click();
            a.remove();
            // some browsers ignore download attr cross-origin; still opens
            resolve();
          }catch(e){
            window.open(url, "_blank");
            resolve();
          }
        });
      }

      document.getElementById("adminResetBtn")?.addEventListener("click", () => {
        localStorage.removeItem("WEDDING_SETTINGS_V1");
        alert("Reset saved data âœ…\nRefresh page to load defaults.");
      });
    }

    function fillFormFromWedding(){
      const g = (id) => document.getElementById(id);
      g("f_title").value = WEDDING.title || "";
      g("f_couple").value = WEDDING.couple || "";
      g("f_dateShort").value = WEDDING.dateShort || "";
      g("f_guestLabel").value = WEDDING.guestLabel || "";
      g("f_bigText").value = WEDDING.bigText || "";
      g("f_dateFull").value = WEDDING.dateFull || "";
      g("f_time").value = WEDDING.time || "";
      g("f_location").value = WEDDING.location || "";
      g("f_desc").value = WEDDING.desc || "";
      g("f_phoneDisplay").value = WEDDING.phoneDisplay || "";
      g("f_phoneTel").value = WEDDING.phoneTel || "";
      g("f_mapLink").value = WEDDING.mapLink || "";
      g("f_slide1").value = (WEDDING.slides && WEDDING.slides[0]) || "";
      g("f_slide2").value = (WEDDING.slides && WEDDING.slides[1]) || "";
      g("f_slide3").value = (WEDDING.slides && WEDDING.slides[2]) || "";
      g("f_slide4").value = (WEDDING.slides && WEDDING.slides[3]) || "";
    }

    function readFormToWedding(){
      const v = (id) => (document.getElementById(id)?.value || "").trim();
      WEDDING.title = v("f_title") || WEDDING.title;
      WEDDING.couple = v("f_couple") || WEDDING.couple;
      WEDDING.dateShort = v("f_dateShort") || WEDDING.dateShort;
      WEDDING.guestLabel = v("f_guestLabel") || WEDDING.guestLabel;
      WEDDING.bigText = v("f_bigText") || WEDDING.bigText;
      WEDDING.dateFull = v("f_dateFull") || WEDDING.dateFull;
      WEDDING.time = v("f_time") || WEDDING.time;
      WEDDING.location = v("f_location") || WEDDING.location;
      WEDDING.desc = document.getElementById("f_desc")?.value || WEDDING.desc;
      WEDDING.phoneDisplay = v("f_phoneDisplay") || WEDDING.phoneDisplay;
      WEDDING.phoneTel = v("f_phoneTel") || WEDDING.phoneTel;
      WEDDING.mapLink = v("f_mapLink") || WEDDING.mapLink;
      WEDDING.slides = [v("f_slide1"), v("f_slide2"), v("f_slide3"), v("f_slide4")].filter(Boolean);
    }

function applyWeddingSettings(){
      const setText = (id, val) => { const el = document.getElementById(id); if(el && val!=null) el.textContent = val; };
      setText("w_title", WEDDING.title);
      setText("w_couple", WEDDING.couple);
      setText("w_date_short", WEDDING.dateShort);
      setText("w_guest_label", WEDDING.guestLabel);
      setText("w_big", WEDDING.bigText);
      setText("w_date_full", WEDDING.dateFull);
      setText("w_time", WEDDING.time);
      setText("w_location", WEDDING.location);
      setText("w_desc", WEDDING.desc);
      setText("w_call_label", WEDDING.callLabel);
      setText("w_phone_display", WEDDING.phoneDisplay);

      const mapBtn = document.getElementById("w_map_btn");
      if(mapBtn){
        mapBtn.href = WEDDING.mapLink;
        mapBtn.textContent = WEDDING.mapLabel;
      }
      const callBtn = document.getElementById("w_call_btn");
      if(callBtn){
        callBtn.href = "tel:" + WEDDING.phoneTel;
        callBtn.textContent = WEDDING.callLabel;
      }

      // Update slideshow backgrounds
      const slides = Array.from(document.querySelectorAll(".slide"));
      slides.forEach((s, idx) => {
        if(WEDDING.slides[idx]) s.style.backgroundImage = `url('${WEDDING.slides[idx]}')`;
      });

      // Update browser title (not Facebook preview)
      document.title = `${WEDDING.title} - ${WEDDING.couple}`;
    }

    document.addEventListener("DOMContentLoaded", () => { loadWeddingFromStorage(); applyWeddingSettings(); applyAdminUiSettings(); initAdminPanel(); });
  </script>

  <div class="wrap">
    <section class="left">
      <div class="slideshow" id="slideshow">
        <div class="slide show" data-slide="0" style="background-image:url(\'https://lh3.googleusercontent.com/d/1Lpi-tYGWk6hDbUNP3aMj1glzxfXoephU\');"></div>
        <div class="slide" data-slide="1" style="background-image:url('https://lh3.googleusercontent.com/d/1ERIlp0vAXIRnovSqZpn3EuLVxeMHZi28');"></div>
        <div class="slide" data-slide="2" style="background-image:url('https://lh3.googleusercontent.com/d/1QviHOrtpGkqMo0kT_lkOjl_wzl7pVphA');"></div>
        <div class="slide" data-slide="3" style="background-image:url('https://lh3.googleusercontent.com/d/1sU696GN2etoBaHsJXBuGBN1ry8L9VNyQ');"></div>
      </div>
    </section>

    <section class="right">
      <div class="glass">
        <div class="title" id="w_title">
          áŸá·ášá¸á˜á„áŸ’á‚á›á¢á¶á–á¶á áŸá–á·á–á¶á áŸ
          <div class="spark" id="spark"></div>
        </div>
        <div class="names" id="w_couple">áŸá™ áœáŸ‰á¶á“áŸ‹áŒá¸ ğŸ’ á¡áŸá„ áŸáŸŠá¶á„á›á¸áŸ</div>
        <div class="date" id="w_date_short">áŸ¡áŸ§ á˜á€ášá¶ áŸ¢áŸ áŸ¢áŸ¦</div>

        <div class="box">
          <div class="guest-label" id="w_guest_label">áŸá¼á˜á‚áŸ„ášá–á¢á‰áŸ’á‡á¾á‰á—áŸ’á‰áŸ€áœá€á·ááŸ’áá·á™áŸ</div>
          <div class="guest-name" id="guestName"></div>
        </div>

        <div class="big" id="w_big">áŸá¼á˜á¢á‰áŸ’á‡á¾á‰á…á¼á›ášá½á˜á–á·á’á¸á¢á¶á–á¶á áŸá–á·á–á¶á áŸ</div>

        
        <div class="info">
          <div><b>ğŸ“…</b><span id="w_date_full">ááŸ’á„áŸƒáŸáŸ…ášáŸ á‘á¸áŸ¡áŸ§ ááŸ‚á˜á€ášá¶ á†áŸ’á“á¶áŸ†áŸ¢áŸ áŸ¢áŸ¦</span></div>
          <div><b>ğŸ•”</b><span id="w_time">áœáŸá›á¶á˜áŸ‰áŸ„á„ áŸ¥áŸ–áŸ áŸ  á›áŸ’á„á¶á…</span></div>
          <div><b>ğŸ“</b><span id="w_location">á—á¼á˜á·á…á“áŸ’á›áŸ„á„ áƒá»áŸ†áŠáŸ†ášá·á› áŸáŸ’ášá»á€á¢á¼ášášá¶áŸ†á„áª ááŸááŸ’áááŸ’á”á¼á„áƒáŸ’á˜á»áŸ†</span></div>
                  </div>

        <div class="desc" id="w_desc">á™á¾á„ááŸ’á‰á»áŸ†á˜á¶á“á€á·ááŸ’áá·á™áŸáŸá¼á˜á‚áŸ„ášá–á¢á‰áŸ’á‡á¾á‰ á¯á€á§ááŸ’áá˜ á›áŸ„á€á§á€á‰áŸ‰á¶ á¢áŸ’á“á€á§á€á‰áŸ‰á¶ á§á€á‰áŸ‰á¶ á›áŸ„á€á‡áŸ†á‘á¶áœ á›áŸ„á€ á›áŸ„á€áŸáŸ’ášá¸ á¢áŸ’á“á€á“á¶á„ á€á‰áŸ’á‰á¶ á¢á‰áŸ’á‡á¾á‰á…á¼á›ášá½á˜ áŠá¾á˜áŸ’á”á¸á”áŸ’ášáŸá·á‘áŸ’á’á·á–ášá‡áŸá™áŸá·ášá¸áŸá½áŸáŸ’áá¸ á‡áŸá™á˜á„áŸ’á‚á› á€áŸ’á“á»á„á–á·á’á¸á¢á¶á–á¶á áŸá–á·á–á¶á áŸ ášá”áŸáŸ‹á‚á¼áŸáŸ’áœá¶á˜á¸á—ášá·á™á¶ááŸ’á˜á¸áŸ”</div>

        <div class="contact">
          <span id="w_call_label">ğŸ“ á áŸ…á¥á¡á¼áœ</span> <span id="w_phone_display">+855 90 598 510</span>
        </div>

        <div class="btns">
          <a class="btn" id="w_map_btn" href="https://goo.gl/maps/KcnLyL4jv2HMGDss9" target="_blank">ğŸ“ á‘á¸áá¶áŸ†á„ (Map)</a>
          <a class="btn" id="w_call_btn" href="tel:+85590598510">ğŸ“ á áŸ…á¥á¡á¼áœ</a>
        </div>
      </div>
    </section>
  </div>

  <script>
    // Guest name from URL
    (function(){
      var params = new URLSearchParams(window.location.search);
      var g = params.get("guest");
      if(g){
        try{ g = decodeURIComponent(g); }catch(e){}
        document.getElementById("guestName").textContent = g;
      }
    })();

    // Slideshow
    (function(){
      var slides = Array.from(document.querySelectorAll(".slide"));
      var i = 0;
      setInterval(function(){
        slides[i].classList.remove("show");
        i = (i + 1) % slides.length;
        slides[i].classList.add("show");
      }, 7000);
    })();

    // Sparkles
    (function(){
      var wrap = document.getElementById("spark");
      for(let i=0;i<12;i++){
        var s = document.createElement("i");
        s.style.left = (5 + Math.random()*90) + "%";
        s.style.top  = (10 + Math.random()*70) + "%";
        s.style.animationDelay = (Math.random()*3) + "s";
        s.style.animationDuration = (3 + Math.random()*2.5) + "s";
        s.style.width = s.style.height = (4 + Math.random()*4) + "px";
        wrap.appendChild(s);
      }
    })();
  </script>
</body>
</html>
